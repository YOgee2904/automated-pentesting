import { Scan } from "../models/model";

export async function saveReport(
  userId: string,
  url: string,
  status: string,
  result: string
) {
  const scan = new Scan({
    userId,
    url,
    status,
    result,
  });

  try {
    await scan.save();
  } catch (error: any) {
    throw new Error(error);
  }
}

export async function getReports(userId: string) {
  try {
    return await Scan.find({ userId });
    }
    catch (error: any) {
    throw new Error(error);
    }
}


// update the status of the scan
export async function updateStatus(userId: string, url: string, status: string) {
  try {
    await Scan.updateOne({ userId,
      url }, { status });
  }
  catch (error: any) {
    throw new Error(error);
  }
}

