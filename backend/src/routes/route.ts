import express, { Request, Response } from "express";
import {
  loginController,
  signupController,
  scanController,
} from "../controllers/controllers";
import { authenticateJWT } from "../_helpers/jwt";
import Zaproxy from "zaproxy";
import { updateStatus } from "../_helpers/saveReport";

const testController = async (req: Request, res: Response) => {
  const zaproxy = new Zaproxy({
    proxy: {
      host: "localhost",
      port: 8090,
    },
  });
  let response = await zaproxy.spider.scanAsUser({
    url: "http://localhost:3000",
  });
  console.log(response);
  res.send("Test");
};

const route = express.Router();

route.post("/login", loginController);
route.post("/signup", signupController);


route.use(authenticateJWT);
route.post("/scan", scanController);
route.post("/scan_test", testController);
export default route;
