import http from "http";
import { Server } from "socket.io";
import express, { Express } from "express";
import mongoose from "mongoose";
import cors from "cors";

export class HttpServer {
  private app = express();
  private server: http.Server;
  private io: Server;
  constructor(private port: number) {
    this.server = http.createServer(this.app);
    this.io = new Server(this.server, {
      cors: {
        origin: "*",
        methods: ["GET", "POST"],
      },
    });
  }
  public async connectToDatabase() {
    try {
      await mongoose.connect("mongodb://localhost:27017/scan");
      console.log("Connected to database");
    } catch (error) {
      console.log("Error connecting to database", error);
    }
  }

  public startServer() {
    this.server.listen(this.port, () => {
      console.log(`Server is running on port ${this.port}`);
    });
  }
  public getIO() {
    return this.io;
  }
  public getApp() {
    return this.app;
  }
}

export default HttpServer;
